-- SetupConfig: { "AddRequires": [ "Model.CK.GuestUserTable" ] } 

create transformer on CK.sAuthUserInfoRead
as
begin
	inject "
	  union all
    select GuestUserId, 'Guest#' + cast(GuestUserId as varchar)
    from CK.tGuestUser with(nolock)
    where GuestUserId = @UserId and @UserId > 0
      and not exists( select 1 from CK.tUser where UserId = @UserId )
	" after first part {select};
end
